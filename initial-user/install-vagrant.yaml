---
# ansible-galaxy install -p ./roles robertdebock.virtualbox
# ansible-galaxy install -p ./roles darkwizard242.vagrant
# ansible-playbook -i hosts.ini install-vagrant.yaml -kK -vvv
- hosts: multipass
  remote_user: devops
  become: yes

  roles: 
  - robertdebock.virtualbox
  - darkwizard242.vagrant

  tasks:
  - name: Show host's ip
    debug:
      msg: "{{ ansible_ssh_host }}"

  - name: deploy vagrant config
    copy:
      src: sub-hosts/{{ ansible_ssh_host }}/Vagrantfile
      dest: /home/devops/vagrant-deploy/Vagrantfile
      owner: devops
      group: devops
      mode: '0755'

  - name: move to vagrant-deploy and launch vms for this host
    shell:
      cmd: vagrant up
      chdir: /home/devops/vagrant-deploy/

